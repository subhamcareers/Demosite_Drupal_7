!function(t,e){"use strict";"function"==typeof define&&define.amd?define([window.dBlazy,window.Bio],e):"object"==typeof exports?module.exports=e(window.dBlazy,window.Bio):t.BioMedia=e(window.dBlazy,window.Bio)}(this,function(t,e){"use strict";function r(t){return o.apply(this,arguments)}var i=t,o=e,s="data-src",n=["src"],a=["srcset","src"],c=r.prototype=Object.create(e.prototype);return c.constructor=r,c.prepare=function(t){return function(){var e=this;if(e.options.breakpoints){var r=[];i.forEach(e.options.breakpoints,function(t){if(n.push(t.src.replace("data-","")),t.width>=e.windowWidth)return s=t.src,r.push(s),!1}),r.length>0&&(s=r[0])}return t.call(this)}}(c.prepare),c.lazyLoad=function(t){return function(e){if(!e.hasAttribute("data-bio-hit")){var r=this,o=e.parentNode,s=i.equal(e,"img"),n=void 0===e.src&&e.classList.contains(r.options.bgClass),a=o&&i.equal(o,"picture"),c=i.equal(e,"video");return a?(i.setAttrsWithSources(e,"srcset",!0),i.setAttr(e,"src",!0),r.loaded(e,r._ok)):c?(i.setAttrsWithSources(e,"src",!0),e.load(),r.loaded(e,r._ok)):s||n?r.setImage(e,n):e.getAttribute("data-src")&&e.hasAttribute("src")&&(i.setAttr(e,"src",!0),r.loaded(e,r._ok)),e.setAttribute("data-bio-hit",1),t.apply(this,arguments)}}}(c.lazyLoad),c.promise=function(t,e){var r=this;return new Promise(function(o,n){var c=new Image;c.src=t.getAttribute(e?s:"data-src"),t.hasAttribute("data-srcset")&&(c.srcset=t.getAttribute("data-srcset"));var u=function(){e?r.setBg(t):i.setAttrs(t,a,!1)};c.onload=function(){u(),o(r._ok)},c.onerror=function(){u(),n(r._er)}})},c.setImage=function(t,e){var r=this;return r.promise(t,e).then(function(o){r.loaded(t,o),i.removeAttrs(t,e?n:a)}).catch(function(e){r.loaded(t,e),t.removeAttribute("data-bio-hit")}).finally(function(){i.trigger(t,"bio.finally",{options:r.options})})},c.setBg=function(t){t.hasAttribute(s)&&(t.style.backgroundImage='url("'+t.getAttribute(s)+'")',t.removeAttribute("src"))},r});
